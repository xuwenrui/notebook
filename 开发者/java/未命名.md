### 主项目（用于配置Tomcat和子项目）

#### `pom.xml`

确保主项目的`pom.xml`文件中包含以下依赖：

xml

复制代码

`<parent>     <groupId>org.springframework.boot</groupId>     <artifactId>spring-boot-starter-parent</artifactId>     <version>2.5.4</version>     <relativePath/> <!-- lookup parent from repository --> </parent>  <dependencies>     <dependency>         <groupId>org.springframework.boot</groupId>         <artifactId>spring-boot-starter-web</artifactId>     </dependency>     <dependency>         <groupId>org.apache.tomcat.embed</groupId>         <artifactId>tomcat-embed-core</artifactId>     </dependency>     <dependency>         <groupId>org.apache.tomcat.embed</groupId>         <artifactId>tomcat-embed-jasper</artifactId>     </dependency>     <dependency>         <groupId>org.apache.tomcat.embed</groupId>         <artifactId>tomcat-embed-websocket</artifactId>     </dependency>     <dependency>         <groupId>com.example</groupId>         <artifactId>projectA</artifactId>         <version>0.0.1-SNAPSHOT</version>     </dependency>     <dependency>         <groupId>com.example</groupId>         <artifactId>projectB</artifactId>         <version>0.0.1-SNAPSHOT</version>     </dependency> </dependencies>`

#### 主类配置 `MultiProjectApplication.java`

配置内置Tomcat来处理多个项目：

java

复制代码

`package com.example.multiproject;  import org.apache.catalina.Context; import org.apache.catalina.startup.Tomcat; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory; import org.springframework.boot.web.server.WebServerFactoryCustomizer; import org.springframework.context.annotation.Bean; import org.springframework.web.context.WebApplicationContext; import org.springframework.web.context.support.AnnotationConfigWebApplicationContext; import org.springframework.web.servlet.DispatcherServlet;  @SpringBootApplication public class MultiProjectApplication {      public static void main(String[] args) {         SpringApplication.run(MultiProjectApplication.class, args);     }      @Bean     public WebServerFactoryCustomizer<TomcatServletWebServerFactory> webServerFactoryCustomizer() {         return factory -> factory.addContextCustomizers(context -> {             Tomcat.addServlet(context, "projectAServlet", createDispatcherServlet("com.example.projectA.Application"));             context.addServletMappingDecoded("/projectA/*", "projectAServlet");                          Tomcat.addServlet(context, "projectBServlet", createDispatcherServlet("com.example.projectB.Application"));             context.addServletMappingDecoded("/projectB/*", "projectBServlet");         });     }      private DispatcherServlet createDispatcherServlet(String configClass) {         AnnotationConfigWebApplicationContext context = new AnnotationConfigWebApplicationContext();         context.setConfigLocation(configClass);         return new DispatcherServlet(context);     } }`

### 子项目（`projectA` 和 `projectB`）

#### 项目A (`projectA`)

`projectA`的`pom.xml`：

xml

复制代码

`<parent>     <groupId>org.springframework.boot</groupId>     <artifactId>spring-boot-starter-parent</artifactId>     <version>2.5.4</version>     <relativePath/> <!-- lookup parent from repository --> </parent>  <dependencies>     <dependency>         <groupId>org.springframework.boot</groupId>         <artifactId>spring-boot-starter-web</artifactId>     </dependency> </dependencies>`

`projectA`的主类：

java

复制代码

`package com.example.projectA;  import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController;  @SpringBootApplication public class Application {      public static void main(String[] args) {         SpringApplication.run(Application.class, args);     }      @RestController     public class ProjectAController {         @GetMapping("/")         public String home() {             return "Hello from Project A";         }     } }`

#### 项目B (`projectB`)

`projectB`的`pom.xml`：

xml

复制代码

`<parent>     <groupId>org.springframework.boot</groupId>     <artifactId>spring-boot-starter-parent</artifactId>     <version>2.5.4</version>     <relativePath/> <!-- lookup parent from repository --> </parent>  <dependencies>     <dependency>         <groupId>org.springframework.boot</groupId>         <artifactId>spring-boot-starter-web</artifactId>     </dependency> </dependencies>`

`projectB`的主类：

java

复制代码

`package com.example.projectB;  import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController;  @SpringBootApplication public class Application {      public static void main(String[] args) {         SpringApplication.run(Application.class, args);     }      @RestController     public class ProjectBController {         @GetMapping("/")         public String home() {             return "Hello from Project B";         }     } }`

### 构建和运行

1. 构建并安装`projectA`和`projectB`到本地Maven仓库：
    
    bash
    
    复制代码
    
    `cd projectA mvn clean install cd ../projectB mvn clean install`
    
2. 运行`multi-project`项目：
    
    bash
    
    复制代码
    
    `cd ../multi-project mvn spring-boot:run`
    
3. 访问以下URL来验证：
    

- `http://localhost:8080/projectA`：应显示 "Hello from Project A"
- `http://localhost:8080/projectB`：应显示 "Hello from Project B"

这样，您就可以在一个Spring Boot内置的Tomcat实例中运行多个项目。











package com.frank.start;  
  
import org.apache.catalina.Context;  
import org.apache.catalina.startup.Tomcat;  
import org.springframework.boot.SpringApplication;  
import org.springframework.boot.autoconfigure.SpringBootApplication;  
import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;  
import org.springframework.boot.web.server.WebServerFactoryCustomizer;  
import org.springframework.context.annotation.Bean;  
import org.springframework.web.context.WebApplicationContext;  
import org.springframework.web.context.support.AnnotationConfigWebApplicationContext;  
import org.springframework.web.servlet.DispatcherServlet;  
  
//@ComponentScan(basePackages = {"com.frank.orderweb","com.frank.userweb"})  
@SpringBootApplication  
public class StartApplication {  
  
    public static void main(String[] args) {  
        SpringApplication.run(StartApplication.class, args);  
    }  
    @Bean  
    public WebServerFactoryCustomizer<TomcatServletWebServerFactory> webServerFactoryCustomizer() {  
        return factory -> factory.addContextCustomizers(context -> {  
            Tomcat.addServlet(context, "orderServlet", createDispatcherServlet("com.frank.orderweb.OrderWebApplication"));  
            context.addServletMappingDecoded("/order/*", "orderServlet");  
  
            Tomcat.addServlet(context, "userServlet", createDispatcherServlet("com.frank.userweb.UserWebApplication"));  
            context.addServletMappingDecoded("/user/*", "userServlet");  
        });  
    }  
    private DispatcherServlet createDispatcherServlet(String configClass) {  
        AnnotationConfigWebApplicationContext context = new AnnotationConfigWebApplicationContext();  
        context.setConfigLocation(configClass);  
        return new DispatcherServlet(context);  
    }  
}


server.servlet.context-path=/api