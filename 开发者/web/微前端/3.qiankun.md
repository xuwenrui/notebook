官网： https://qiankun.umijs.org/zh/guide

### 一、创建主项目（main-app）
#### 1. 创建主项目
```shell
# 使用 Vite 创建主应用 
npm create vite@latest main-app --template react 
cd main-app 
npm install
```
#### 2. 安装 qiankun
npm install qiankun --save

#### 3. 修改 `src/main.jsx`（或 `main.js`）
```jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
```
#### 4. 修改 `src/App.jsx`
```jsx
import React from 'react';
import { BrowserRouter as Router, Routes, Route, Link } from 'react-router-dom';
import { registerMicroApps, start } from 'qiankun';

// 只注册一次微应用
registerMicroApps([
  {
    name: 'sub-app',
    entry: 'http://localhost:5174/', // 必须是 http 协议
    container: '#subapp-viewport',
    activeRule: '/sub-app',
  },
]);
start();

function App() {
  return (
    <Router>
      <nav>
        <Link to="/">首页</Link> | <Link to="/sub-app">子应用</Link>
      </nav>
      <Routes>
        <Route path="/" element={<h2>主应用首页</h2>} />
        <Route path="/sub-app" element={<div id="subapp-viewport" style={{ height: '100vh' }} />} />
      </Routes>
    </Router>
  );
}

export default App;
```
#### 5. 安装 react-router-dom
`npm install react-router-dom`

#### 6.vite.config.js
```js
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react()],
})
```
#### 7. 启动主项目
`npm run dev`

### 二、创建子项目（sub-app）
#### 1. 创建子项目
```shell
npm create vite@latest sub-app --template react
cd sub-app
npm install
```
#### 2. 安装 qiankun 支持
`npm install --save qiankun`

#### 3. 配置 Vite 输出为 UMD 格式（用于 qiankun 加载）
	修改 `vite.config.js`：
```js
import react from "@vitejs/plugin-react";
import { defineConfig } from "vite";
import qiankunPlugin from "vite-plugin-qiankun";

const qiankun = qiankunPlugin.qiankun || qiankunPlugin;

export default defineConfig({
  server: {
    headers: {
      "Access-Control-Allow-Origin": "*", // 允许跨域
    },
  },
  plugins: [
    react(),
    qiankun("sub-app", {
      // 'sub-app' 为子应用名称
      useDevMode: true, // 开发环境必须加这一行
    }),
  ],
  build: {
    target: "es2015",
    outDir: "dist",
    lib: {
      entry: "./src/main.jsx",
      name: "subApp",
      fileName: (format) => `index.${format}.js`,
      formats: ["umd"],
    },
    rollupOptions: {
      external: ["react", "react-dom"],
      output: {
        globals: {
          react: "React",
          "react-dom": "ReactDOM",
        },
      },
    },
  },
});

```

#### 4. 修改 `src/main.js`
```js
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";

let root = null;

function render() {
  root = ReactDOM.createRoot(document.getElementById("root"));
  root.render(<App />);
}

if (!window.__POWERED_BY_QIANKUN__) {
  render();
}

export async function bootstrap() {}
export async function mount() {
  render();
}
export async function unmount() {
  root.unmount();
}
```
#### 5. 修改 `src/App.jsx`（子项目页面）
```jsx
import React from 'react';

function App() {
  return (
    <div>
      <h2>子应用页面</h2>
      <p>这是子应用的内容</p>
    </div>
  );
}

export default App;
```